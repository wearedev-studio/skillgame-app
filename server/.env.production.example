# ========== PRODUCTION SECURITY CONFIGURATION ==========
# This file contains production-ready security settings
# Copy to .env and update with your actual values

# ========== APPLICATION SETTINGS ==========
NODE_ENV=production
PORT=5000

# ========== DATABASE CONFIGURATION ==========
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/skillgame-pro?retryWrites=true&w=majority
DB_NAME=skillgame-pro

# ========== JWT CONFIGURATION ==========
# CRITICAL: Generate a strong 64+ character secret
JWT_SECRET=GENERATE_STRONG_SECRET_HERE_MIN_64_CHARS_WITH_RANDOM_ALPHANUMERIC_AND_SPECIAL_CHARS
JWT_EXPIRES_IN=24h

# ========== REDIS CONFIGURATION (REQUIRED FOR SECURITY) ==========
REDIS_HOST=your-redis-host.com
REDIS_PORT=6380
REDIS_PASSWORD=your-strong-redis-password
REDIS_DB=0

# ========== PRODUCTION SECURITY CONFIGURATION ==========

# CORS Settings - CRITICAL: Only allow your domains
ALLOWED_ORIGINS=https://platform.skillgame.pro,https://crm.skillgame.pro

# Rate Limiting - Production values
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=500
AUTH_RATE_LIMIT_MAX=3
ADMIN_RATE_LIMIT_MAX=50
SPEED_LIMIT_DELAY_AFTER=1
SPEED_LIMIT_DELAY_MS=1000

# Brute Force Protection - Strict settings
MAX_LOGIN_ATTEMPTS=3
LOCKOUT_TIME_MS=3600000
BRUTE_FORCE_ENABLED=true

# CSRF Protection - Enabled
CSRF_TOKEN_LENGTH=32
CSRF_TOKEN_EXPIRY=1800000
CSRF_COOKIE_NAME=csrf-token
CSRF_HEADER_NAME=x-csrf-token
CSRF_ENABLED=true

# XSS Protection - Maximum security
XSS_PROTECTION_ENABLED=true
XSS_SANITIZATION_LEVEL=strict

# Security Headers - All enabled
HELMET_ENABLED=true
SECURITY_HEADERS_ENABLED=true
CONTENT_SECURITY_POLICY_ENABLED=true
REFERRER_POLICY=strict-origin-when-cross-origin

# File Upload Security - Strict limits
MAX_FILE_SIZE=2097152
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf
SCAN_UPLOADED_FILES=true
QUARANTINE_SUSPICIOUS_FILES=true

# Geographic Restrictions
BLOCKED_COUNTRIES=CN,RU,KP,IR
ENABLE_GEOBLOCKING=true

# Session Management - Secure settings
SESSION_TIMEOUT_MS=43200000
MAX_CONCURRENT_SESSIONS=3
SESSION_TRACKING_ENABLED=true
FORCE_LOGOUT_ON_SECURITY_BREACH=true

# IP Security - Production settings
AUTO_BLOCK_SUSPICIOUS_IPS=true
IP_BLOCK_DURATION_MS=7200000
MAX_REQUESTS_PER_IP_PER_MINUTE=60
ADMIN_IP_WHITELIST_ENABLED=true
ADMIN_IP_WHITELIST=YOUR_ADMIN_IPS_HERE

# ========== PAYMENT GATEWAY CONFIGURATION ==========
PAYMENT_PROVIDER=g2pay
PAYMENT_API_URL=https://api.g2pay.com
PAYMENT_API_KEY=your-production-payment-api-key
PAYMENT_SECRET_KEY=your-production-payment-secret-key
PAYMENT_WEBHOOK_SECRET=your-production-webhook-secret

# ========== EMAIL CONFIGURATION ==========
EMAIL_PROVIDER=smtp
EMAIL_HOST=smtp.your-domain.com
EMAIL_PORT=587
EMAIL_USER=security@skillgame.pro
EMAIL_PASS=your-secure-email-password
EMAIL_FROM=security@skillgame.pro

# ========== SECURITY LOGGING ==========
LOG_LEVEL=warn
LOG_TO_FILE=true
LOG_DIRECTORY=./logs
SECURITY_LOG_RETENTION_DAYS=90

# ========== MONITORING AND ALERTS ==========
ENABLE_SECURITY_MONITORING=true
ENABLE_REAL_TIME_ALERTS=true
ALERT_COOLDOWN_MS=300000
SECURITY_METRICS_RETENTION_DAYS=365

# Threat Detection - Production thresholds
THREAT_DETECTION_THRESHOLD=5
SUSPICIOUS_ACTIVITY_THRESHOLD=3
COORDINATED_ATTACK_THRESHOLD=10
DDOS_DETECTION_THRESHOLD=500

# Security Dashboard
SECURITY_DASHBOARD_ENABLED=true
REALTIME_SECURITY_UPDATES=true
SECURITY_SCORE_CALCULATION=true
THREAT_INTELLIGENCE_ENABLED=true

# Alert Configuration
SECURITY_WEBHOOK_URL=https://hooks.slack.com/your-webhook
SLACK_WEBHOOK_URL=https://hooks.slack.com/your-webhook
EMAIL_SECURITY_ALERTS=true
SMS_SECURITY_ALERTS=true

# Alert Timing
CRITICAL_ALERT_IMMEDIATE=true
HIGH_ALERT_DELAY_MS=0
MEDIUM_ALERT_DELAY_MS=60000
LOW_ALERT_DELAY_MS=300000

# ========== FILE STORAGE ==========
UPLOAD_PATH=./public/uploads
KYC_UPLOAD_PATH=./private/kyc-documents
MAX_STORAGE_SIZE=10737418240

# ========== PRODUCTION SECURITY HEADERS ==========
HSTS_MAX_AGE=31536000
CSP_REPORT_URI=https://skillgame.pro/csp-report

# ========== ADVANCED SECURITY FEATURES ==========
ENABLE_HONEYPOTS=true
HONEYPOT_ENDPOINTS=/admin,/wp-admin,/.env,/config.php

# Pattern Analysis
ENABLE_CUSTOM_SECURITY_PATTERNS=true
PATTERN_ANALYSIS_ENABLED=true
BEHAVIORAL_ANALYSIS_ENABLED=true
SCAN_REQUEST_HEADERS=true
SCAN_REQUEST_BODY=true
SCAN_URL_PARAMETERS=true

# Automatic Security Response
AUTO_BLOCK_ON_THREAT=true
AUTO_ESCALATE_REPEATED_OFFENSES=true
SECURITY_LOCKDOWN_MODE=false

# Security Forensics
ENABLE_SECURITY_FORENSICS=true
CAPTURE_ATTACK_EVIDENCE=true
DETAILED_SECURITY_LOGGING=true
EVIDENCE_RETENTION_DAYS=365

# ========== PERFORMANCE OPTIMIZATION ==========
ENABLE_COMPRESSION=true
COMPRESSION_LEVEL=6
CACHE_TTL_SECONDS=1800

# ========== COMPLIANCE AND PRIVACY ==========
GDPR_COMPLIANCE=true
DATA_RETENTION_DAYS=2555
PRIVACY_POLICY_VERSION=1.0
TERMS_OF_SERVICE_VERSION=1.0

# ========== FEATURE FLAGS ==========
ENABLE_TWO_FACTOR_AUTH=true
ENABLE_DEVICE_TRACKING=true
ENABLE_LOGIN_HISTORY=true
ENABLE_AUDIT_LOGGING=true

# ========== ERROR HANDLING ==========
ERROR_STACK_TRACE_LIMIT=0
SENTRY_DSN=your-production-sentry-dsn
ERROR_REPORTING_LEVEL=error

# ========== DEVELOPMENT SETTINGS (DISABLE IN PRODUCTION) ==========
ENABLE_DEBUG_LOGS=false
DISABLE_RATE_LIMITING=false
MOCK_PAYMENT_GATEWAY=false
ENABLE_API_DOCS=false
ENABLE_PROFILING=false

# ========== MISC CONFIGURATION ==========
TIMEZONE=UTC
DEFAULT_LANGUAGE=en
CURRENCY_CODE=USD
MINIMUM_WITHDRAWAL=10
MAXIMUM_WITHDRAWAL=10000